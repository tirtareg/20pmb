dw$daily_rec <- 0
for (i in 1 : nrow(dw)) {
if (i == 1) {
dw$daily_rec[i] <- 0
} else {
dw$daily_rec[i] <- dw$recovered[i] - dw$recovered[i - 1]
}
}
dw
dw
dw <- filter(dw, date > "2020-02-15")
dw
plotly::plot_ly(data = dw) %>%
plotly::add_trace(
x = ~date,
y = ~daily_con,
type = "scatter",
mode = "lines+markers",
name = "Terkonfirmasi",
line = list(color = confirmed_color),
marker = list(color = confirmed_color)
) %>%
plotly::add_trace(
x = ~date,
y = ~daily_dea,
type = "scatter",
mode = "lines+markers",
name = "Meninggal",
line = list(color = death_color),
marker = list(color = death_color)
) %>%
plotly::add_trace(
x = ~date,
y = ~daily_rec,
type = "scatter",
mode = "lines+markers",
name = "Sembuh",
line = list(color = recovered_color),
marker = list(color = recovered_color)
) %>%
plotly::layout(
title = "",
yaxis = list(title = "Banyaknya kasus"),
xaxis = list(title = "Tanggal"),
legend = list(x = 0.1, y = 0.9),
hovermode = "compare"
)
plotly::plot_ly(data = dw) %>%
plotly::add_trace(
x = ~date,
y = ~daily_con,
type = "scatter",
mode = "lines+markers",
name = "Terkonfirmasi",
line = list(color = confirmed_color),
marker = list(color = confirmed_color)
)
dw
tail(dw)
plotly::plot_ly(data = dw[-nrow(dw),]) %>%
plotly::add_trace(
x = ~date,
y = ~daily_con,
type = "scatter",
mode = "lines+markers",
name = "Terkonfirmasi",
line = list(color = confirmed_color),
marker = list(color = confirmed_color)
)
plotly::plot_ly(data = dw[-nrow(dw),]) %>%
plotly::add_trace(
x = ~date,
y = ~daily_con,
type = "scatter",
mode = "lines+markers",
name = "Terkonfirmasi",
line = list(color = confirmed_color),
marker = list(color = confirmed_color)
) %>%
plotly::add_trace(
x = ~date,
y = ~daily_dea,
type = "scatter",
mode = "lines+markers",
name = "Meninggal",
line = list(color = death_color),
marker = list(color = death_color)
) %>%
plotly::add_trace(
x = ~date,
y = ~daily_rec,
type = "scatter",
mode = "lines+markers",
name = "Sembuh",
line = list(color = recovered_color),
marker = list(color = recovered_color)
) %>%
plotly::layout(
title = "",
yaxis = list(title = "Banyaknya kasus"),
xaxis = list(title = "Tanggal"),
legend = list(x = 0.1, y = 0.9),
hovermode = "compare"
)
dr <- data %>%
select(Country.Region, date, confirmed, death, recovered)
#dr$Country.Region <- fct_explicit_na(dr$Country.Region)
dr <- dr %>%
group_by(Country.Region) %>%
filter(date == max(date))
dr <- dr %>%
group_by(Country.Region) %>%
summarize(confirmed = sum(confirmed, na.rm = T),
death = sum(death, na.rm = T),
recovered = sum(recovered, na.rm = T))
dr <- dr %>%
mutate(death_rate = round(death / confirmed *100, 2)) %>%
filter(confirmed > 0) %>%
arrange(desc(death))
dr1 <- dr
names(dr1) <- c("Negara", "Terkonfirmasi", "Meninggal", "Sembuh", "Tingkat Kematian (%)")
DT::datatable(dr1, options = list(lengthMenu = c(10, 20, 50, 100), pageLength = 10))
dr <- data %>%
select(Country.Region, date, confirmed, death, recovered)
dr
#dr$Country.Region <- fct_explicit_na(dr$Country.Region)
dr <- dr %>%
group_by(Country.Region) %>%
filter(date == max(date))
dr
#dr$Country.Region <- fct_explicit_na(dr$Country.Region)
dr <- dr %>%
group_by(Country.Region) %>%
filter(date == (max(date)-1))
dr <- dr %>%
group_by(Country.Region) %>%
summarize(confirmed = sum(confirmed, na.rm = T),
death = sum(death, na.rm = T),
recovered = sum(recovered, na.rm = T))
dr <- dr %>%
mutate(death_rate = round(death / confirmed *100, 2)) %>%
filter(confirmed > 0) %>%
arrange(desc(death))
dr1 <- dr
names(dr1) <- c("Negara", "Terkonfirmasi", "Meninggal", "Sembuh", "Tingkat Kematian (%)")
DT::datatable(dr1, options = list(lengthMenu = c(10, 20, 50, 100), pageLength = 10))
dr <- data %>%
select(Country.Region, date, confirmed, death, recovered)
#dr$Country.Region <- fct_explicit_na(dr$Country.Region)
dr <- dr %>%
group_by(Country.Region) %>%
filter(date == (max(date)-1))
dr
dr <- dr %>%
group_by(Country.Region) %>%
summarize(confirmed = sum(confirmed, na.rm = T),
death = sum(death, na.rm = T),
recovered = sum(recovered, na.rm = T))
dr
dr <- dr %>%
mutate(death_rate = round(death / confirmed *100, 2)) %>%
filter(confirmed > 0) %>%
arrange(desc(death))
dr
dr1 <- dr
names(dr1) <- c("Negara", "Terkonfirmasi", "Meninggal", "Sembuh", "Tingkat Kematian (%)")
dr1
DT::datatable(dr1, options = list(lengthMenu = c(10, 20, 50, 100), pageLength = 10))
dr1 <- dr[1:15,]
dr1 <- dr1 %>%
arrange(desc(death_rate))
dr1$Country.Region <- factor(dr1$Country.Region, levels = dr1$Country.Region)
plotly::plot_ly(
data = dr1,
x = ~Country.Region,
y = ~death_rate,
# text =  ~ confirmed,
# textposition = 'auto',
type = "bar",
name = "Dirawat",
marker = list(color = death_color)
) %>%
plotly::layout(
title = "",
yaxis = list(title = "Tingkat Kematian (%)"),
xaxis = list(title = "Negara"),
hovermode = "compare"
)
plotly::plot_ly(data = db) %>%
plotly::add_trace(
x = ~date,
y = ~confirmed,
type = "scatter",
mode = "lines+markers",
name = "Terkonfirmasi",
line = list(color = confirmed_color),
marker = list(color = confirmed_color)
) %>%
plotly::add_trace(
x = ~date,
y = ~death,
type = "scatter",
mode = "lines+markers",
name = "Meninggal",
line = list(color = death_color),
marker = list(color = death_color)
) %>%
plotly::add_trace(
x = ~date,
y = ~recovered,
type = "scatter",
mode = "lines+markers",
name = "Sembuh",
line = list(color = recovered_color),
marker = list(color = recovered_color)
) %>%
plotly::add_annotations(
x = as.Date("2020-03-02"),
y = 1,
text = paste("Kasus Pertama"),
xref = "x",
yref = "y",
arrowhead = 5,
arrowhead = 3,
arrowsize = 1,
showarrow = TRUE,
ax = -90,
ay = -90
) %>%
plotly::add_annotations(
x = as.Date("2020-03-11"),
y = 3,
text = paste("Kematian Pertama"),
xref = "x",
yref = "y",
arrowhead = 5,
arrowhead = 3,
arrowsize = 1,
showarrow = TRUE,
ax = -10,
ay = -90
) %>%
plotly::layout(
title = "",
yaxis = list(title = "Banyaknya kasus (kumulatif)"),
xaxis = list(title = "Tanggal"),
legend = list(x = 0.1, y = 0.9),
hovermode = "compare"
)
db2 <- data %>%
filter(Country.Region == "Malaysia" | Country.Region == "Indonesia" |
Country.Region == "Singapore" | Country.Region == "Japan") %>%
filter(date == max(date))
db2 <- db2 %>%
mutate(unrecovered = confirmed - death -recovered,
country = factor(Country.Region, levels = Country.Region))
plotly::plot_ly(
data = db2,
x = ~country,
y = ~unrecovered,
# text =  ~ confirmed,
# textposition = 'auto',
type = "bar",
name = "Dirawat",
marker = list(color = active_color)
) %>%
plotly::add_trace(
y = ~recovered,
# text =  ~ death,
# textposition = 'auto',
name = "Sembuh",
marker = list(color = recovered_color)
) %>%
plotly::add_trace(
y = ~death,
# text =  ~ death,
# textposition = 'auto',
name = "Meninggal",
marker = list(color = death_color)
) %>%
plotly::layout(
barmode = "stack",
yaxis = list(title = "Total Kasus"),
xaxis = list(title = ""),
hovermode = "compare",
margin = list(
# l = 60,
# r = 40,
b = 10,
t = 10,
pad = 2
)
)
str(db2)
db2
db2 <- data %>%
filter(Country.Region == "Malaysia" | Country.Region == "Indonesia" |
Country.Region == "Singapore" | Country.Region == "Japan") %>%
filter(date == (max(date)-1))
db2 <- db2 %>%
mutate(unrecovered = confirmed - death -recovered,
country = factor(Country.Region, levels = Country.Region))
plotly::plot_ly(
data = db2,
x = ~country,
y = ~unrecovered,
# text =  ~ confirmed,
# textposition = 'auto',
type = "bar",
name = "Dirawat",
marker = list(color = active_color)
) %>%
plotly::add_trace(
y = ~recovered,
# text =  ~ death,
# textposition = 'auto',
name = "Sembuh",
marker = list(color = recovered_color)
) %>%
plotly::add_trace(
y = ~death,
# text =  ~ death,
# textposition = 'auto',
name = "Meninggal",
marker = list(color = death_color)
) %>%
plotly::layout(
barmode = "stack",
yaxis = list(title = "Total Kasus"),
xaxis = list(title = ""),
hovermode = "compare",
margin = list(
# l = 60,
# r = 40,
b = 10,
t = 10,
pad = 2
)
)
setwd("~/Github Publish/Corona1")
setwd("G:/My Drive/#PMB/2020/03_SMMPTN/Dashboard/20smm")
setwd("G:/My Drive/#PMB/2020/Dashboard/20pmb")
library(tidyverse)
library(readxl)
db <- read_excel("G:/My Drive/#PMB/2021/Dashboard/maba21_4web.xlsx")
db
data <- db %>%
group_by(jalur) %>%
summarize(lolos = n(),
regis = sum(registrasi == "registrasi", na.rm = T),
nim = sum(nim == "diterima", na.rm = T))
data
setwd("G:/My Drive/#PMB/2021/Dashboard/21pmb")
db <- read_excel("G:/My Drive/#PMB/2021/Dashboard/maba21_4web.xlsx")
dim(db)
data <- db %>%
filter(nim == "diterima" & jalur != "7_Pascasarjana") %>%
group_by(negeri) %>%
summarize(banyak = n())
data <- db %>%
filter(nim == "diterima" & jalur != "7_Pascasarjana") %>%
group_by(negeri) %>%
summarize(banyak = n())
div(plot_ly(type = "pie", labels = data$negeri, values = data$banyak,
textinfo = "label+percent",
insidetextorientation = "radial"), align = "center")
library(plotly)
library(shiny)
data <- db %>%
filter(nim == "diterima") %>%
group_by(jk, fakultas) %>%
summarize(total = n()) %>%
pivot_wider(names_from = jk, values_from = total)
names(data) <- c("Fakultas", "Laki-Laki", "Perempuan")
data$Fakultas <- c("Hukum", "FKIP", "Teknik", "Pertanian", "FEB", "FISIP", "Pascasarjana","Kedokteran")
data <- db %>%
filter(nim == "diterima") %>%
group_by(jk, fakultas) %>%
summarize(total = n()) %>%
pivot_wider(names_from = jk, values_from = total)
names(data) <- c("Fakultas", "Laki-Laki", "Perempuan")
### agar sesuai urutan dibuat faktor dengan level yang berurutan
data$Fakultas <- factor(data$Fakultas, levels = data[["Fakultas"]])
plot_ly(data, x = ~Fakultas, y = ~`Laki-Laki`, type = 'bar', name = "Laki-Laki") %>%
add_trace(y = ~Perempuan, name = "Perempuan") %>%
layout(yaxis = list(title = ' '), barmode = 'group')
library(janitor)
library(kableExtra)
data <- adorn_totals(data, where = c("row", "col"), name = "JML")
kable(data) %>%
kable_styling(bootstrap_options = "striped", full_width = F,
latex_options = "scale_down") %>%
add_header_above(c(" " = 1, "Jenis Kelamin" = 2, " " = 1))
data <- db %>%
filter(nim == "diterima" & jalur != "7_Pascasarjana") %>%
group_by(negeri) %>%
summarize(banyak = n())
div(plot_ly(type = "pie", labels = data$negeri, values = data$banyak,
textinfo = "label+percent",
insidetextorientation = "radial"), align = "center")
data <- db %>%
filter(nim == "diterima" & jalur != "7_Pascasarjana") %>%
group_by(jns_sklh) %>%
summarize(banyak = n())
div(plot_ly(type = "pie", labels = data$jns_sklh, values = data$banyak,
textinfo = "label+percent",
insidetextorientation = "radial"), align = "center")
data <- db %>%
filter(nim == "diterima" & jalur != "7_Pascasarjana") %>%
group_by(provinsi, jk) %>%
summarize(tot = n())
data <- data %>%
pivot_wider(names_from = jk, values_from = tot)
data[is.na(data)] <- 0
data <- adorn_totals(data, where = "col", name = "JML")
data <- arrange(data, desc(JML))
data <- adorn_totals(data, where = "row", name = "JML")
names(data) <- c("Provinsi", "Perempuan", "Laki-Laki", "JML")
kable(data) %>%
kable_styling(bootstrap_options = "striped", full_width = F,
latex_options = "scale_down") %>%
add_header_above(c(" " = 1, "Jenis Kelamin" = 2, " " = 1))
data <- db %>%
group_by(fakultas, prodi, jalur) %>%
summarize(pendaftar = max(peminat),
lulus = n(),
sudah = sum(na.omit(registrasi == "registrasi")),
belum = lulus - sudah,
diterima = sum(na.omit(nim == "diterima")))
data <- data %>%
group_by(fakultas) %>%
summarize(pendaftar = sum(pendaftar),
lulus = sum(lulus),
sudah = sum(sudah),
belum = sum(belum),
diterima = sum(diterima))
data$fakultas  <- factor(data$fakultas, levels = data[["fakultas"]])
plot_ly(data, x = ~fakultas, y = ~lulus, type = "bar", name = "Total") %>%
add_trace(y = ~sudah, name = "registrasi berkas") %>%
add_trace(y = ~diterima, name = "bayar UKT") %>%
layout(
title = "",
yaxis = list(title = ""),
xaxis = list(title = "Fakultas"),
hovermode = "compare"
)
data <- adorn_totals(data, where = "row", name = "Total")
data$pers_sudah <- round(data$sudah / data$lulus * 100, 0)
data$pers_belum <- round(data$belum / data$lulus * 100, 0)
data <- data[,c(1:5,7:8,6)]
kable(data) %>%
kable_styling(bootstrap_options = "striped", full_width = F,
latex_options = "scale_down") %>%
add_header_above(c(" " = 3, "Registrasi Berkas" = 4," " = 1))
data <- db %>%
group_by(fakultas, prodi, jalur) %>%
summarize(pendaftar = max(peminat),
lulus = n(),
sudah = sum(na.omit(registrasi == "registrasi")),
belum = lulus - sudah,
diterima = sum(na.omit(nim == "diterima")))
data <- data %>%
group_by(fakultas, prodi) %>%
summarize(pendaftar = sum(pendaftar),
lulus = sum(lulus),
sudah = sum(sudah),
belum = sum(belum),
diterima = sum(diterima))
data <- data[, -1]
data <- adorn_totals(data,where = "row", name = "Total")
data$pers_sudah <- round(data$sudah / data$lulus * 100, 0)
data$pers_belum <- round(data$belum / data$lulus * 100, 0)
data <- data[,c(1:5, 7, 8, 6)]
kable(data, row.names = F) %>%
kable_styling(bootstrap_options = "striped", full_width = F,
latex_options = "scale_down") %>%
add_header_above(c(" " = 3, "Registrasi" = 4, " " = 1)) %>%
pack_rows("Hukum", 1, 1, label_row_css = "background-color: #666; color: #fff;") %>%
pack_rows("Keguruan dan Ilmu Pendidikan", 2, 19, label_row_css = "background-color: #666; color: #fff;") %>%
pack_rows("Teknik", 20, 25, label_row_css = "background-color: #666; color: #fff;") %>%
pack_rows("Pertanian", 26, 29, label_row_css = "background-color: #666; color: #fff;") %>%
pack_rows("Ekonomi dan Bisnis", 30, 37, label_row_css = "background-color: #666; color: #fff;") %>%
pack_rows("Ilmu Sosial dan Ilmu Politik", 38, 40, label_row_css = "background-color: #666; color: #fff;") %>%
pack_rows("Pascasarjana", 41, 52, label_row_css = "background-color: #666; color: #fff;") %>%
pack_rows("Kedokteran", 53, 57, label_row_css = "background-color: #666; color: #fff;")
library(tidyverse)
library(readxl)
db <- read_excel("G:/My Drive/#PMB/2021/Dashboard/maba21_4web.xlsx")
data <- db %>%
group_by(jalur) %>%
summarize(lolos = n(),
regis = sum(registrasi == "registrasi", na.rm = T),
nim = sum(nim == "diterima", na.rm = T))
data
data <- db %>%
group_by(jalur, jenjang) %>%
summarize(lolos = n(),
regis = sum(registrasi == "registrasi", na.rm = T),
nim = sum(nim == "diterima", na.rm = T))
db <- read_excel("G:/My Drive/#PMB/2021/Dashboard/maba21_4web.xlsx")
data <- db %>%
group_by(jalur, jenjang) %>%
summarize(lolos = n(),
regis = sum(registrasi == "registrasi", na.rm = T),
nim = sum(nim == "diterima", na.rm = T))
db <- read_excel("G:/My Drive/#PMB/2021/Dashboard/maba21_4web.xlsx")
data <- db %>%
group_by(jalur, jenjang) %>%
summarize(lolos = n(),
regis = sum(registrasi == "registrasi", na.rm = T),
nim = sum(nim == "diterima", na.rm = T))
data
